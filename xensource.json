{
  "xensource_log_module_format" : {
    "title" : "xensource.log",
    "description" : "XenServer logs stored in /var/log/xensource.log",
    "url" : "https://github.com/xapi-project/xcp-idl/blob/master/lib/debug.ml#L110",
    "file-pattern" : ".*\\/(xensource|audit|daemon)\\.log(\\..+)?",
    "regex" : {
      "xensource_log" : {
        "pattern" : "\\[((?<xapi_timestamp>[^\\[\\|]+)\\|)?(?<level>[^\\[\\|]+)\\|(?<xapi_hostname>[^\\|]+)\\|(?<threadid>\\d+) (?<origin>[^\\|]+)?\\|(?<task>[^\\|]+)?\\|(?<module>[^\\]\\|]+)\\]( (?<body>.*))?",
        "module-format" : true
      }
    },
    "json" : false,

    "level-field" : "level",
    "body-field" : "body",
    "opid-field" : "task",

    "level" : {
      "error" : "error",
      "warning" : "warn",
      "info" : "info",
      "debug" : "debug"
    },
    "multiline" : false,
    "value" : {
      "xapi_timestamp" : {
        "kind" : "string",
        "identifier" : false
      },
      "level" : {
        "kind" : "string",
        "identifier" : false
      },
      "xapi_hostname" : {
        "kind" : "string",
        "collate" : "ipaddress",
        "identifier" : true
      },
      "threadid" : {
        "kind" : "integer",
        "identifier" : true,
        "foreign-key" : true
      },
      "origin" : {
        "kind" : "string",
        "identifier" : false
      },
      "task" : {
        "kind" : "string",
        "identifier" : false
      },
      "module" : {
        "kind" : "string",
        "identifier" : true
      }
    },
    "sample" : [
      {
        "line" : " [debug|dt14|6380 UNIX /var/lib/xcp/xapi|host.signal_networking_change D:4f4b1253f01a|helpers] Updating IP addresses in DB for DHCP and autoconf PIFs",
        "level" : "debug"
      },
      {
        "line" : " message repeated 25 times: [ [debug|localhost|0 ||xenops_server] Adding a new worker to the thread pool]",
        "level" : "debug"
      }
    ]
  }
}
